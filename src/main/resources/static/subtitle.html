<!DOCTYPE HTML>
<html lang=zh-cn>
<head>
<meta charset=utf-8>
<title>字幕</title>
<style>
*{margin:0px;padding:0px;}
body{width:100%;height:100%;overflow:hidden;}
.box{display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:center;margin:5px;padding:5px;-webkit-user-select:none;}
.box:hover{background-color:rgba(0,0,0,0.4);-webkit-box-shadow:0 0 5px #646464;cursor:pointer;}
.box:hover .ctrl{display:block;}
.text{position:relative;top:8px;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:center;font:normal normal bold 60px 微软雅黑,sans-serif;-webkit-filter:brightness(2);}
.text p{
	background:-webkit-linear-gradient(top, rgba(255,255,255,0.5) 0%, rgba(255,255,255,0) 100%), -webkit-linear-gradient(left, #f00 0%, #00f 0%);
	-webkit-background-clip:text;
	-webkit-text-fill-color:transparent;
	/*-webkit-text-stroke:1px #f00;*/
	-webkit-filter:drop-shadow(0px 0px 1px #f00);
	font-size: 200px;
}
.ctrl{position:relative;top:25px;height:20px;background:#0aa;display:-webkit-box;-webkit-box-shadow:0 0 5px #646464;display:none;border-radius:4px;}
.ctrl span{padding:0 10px;}
.ctrl span:hover{background:#088;cursor:pointer;}
</style>
</head>
<body>

	<span id="screen_mark"></span>
	<section>	
		<div class="box" id="box">
			<div class="text" id="text">
			</div>
			<div class="ctrl"><span id="bigger">放大</span><span id="smaller">缩小</span><span id="lock">锁定</span><span id="close">关闭</span></div>
		</div>
	</section>


	<script src="./js/jquery-2.1.4.min.js"></script>


	<script language="javascript">
		(function(){

			/*
krc歌词解析目标格式要求
var lines = [{'ws':[{'w':word, 'o':offset, 'd':duration},{'w':word, 'o':offset, 'd':duration},...], 'o':offset, 'd':duration},
			 {'ws':[{'w':word, 'o':offset, 'd':duration},{'w':word, 'o':offset, 'd':duration},...], 'o':offset, 'd':duration},
			 ...]
*/
//一下是模拟krc解析后的歌词数据
var lines = [{"d":1228,"o":1965,"ws":[{"d":543,"o":0,"w":"明"},{"d":36,"o":543,"w":"天"},{"d":36,"o":579,"w":"会"},{"d":37,"o":615,"w":"更"},{"d":36,"o":652,"w":"好"},{"d":36,"o":688,"w":"("},{"d":37,"o":724,"w":"六"},{"d":35,"o":761,"w":"十"},{"d":36,"o":796,"w":"位"},{"d":35,"o":832,"w":"歌"},{"d":37,"o":867,"w":"手"},{"d":36,"o":904,"w":"大"},{"d":36,"o":940,"w":"合"},{"d":36,"o":976,"w":"唱"},{"d":36,"o":1012,"w":")"},{"d":36,"o":1048,"w":"-"},{"d":36,"o":1084,"w":"华"},{"d":36,"o":1120,"w":"语"},{"d":36,"o":1156,"w":"群"},{"d":36,"o":1192,"w":"星"}]},{"d":1048,"o":3213,"ws":[{"d":36,"o":0,"w":"词"},{"d":37,"o":36,"w":"："},{"d":36,"o":73,"w":"罗"},{"d":36,"o":109,"w":"大"},{"d":36,"o":145,"w":"佑"},{"d":36,"o":181,"w":""},{"d":36,"o":217,"w":"张"},{"d":37,"o":253,"w":"大"},{"d":36,"o":290,"w":"春"},{"d":36,"o":326,"w":""},{"d":35,"o":362,"w":"许"},{"d":36,"o":397,"w":"乃"},{"d":36,"o":433,"w":"胜"},{"d":37,"o":469,"w":""},{"d":36,"o":506,"w":"李"},{"d":36,"o":542,"w":"寿"},{"d":37,"o":578,"w":"全"},{"d":35,"o":615,"w":""},{"d":36,"o":650,"w":"邱"},{"d":36,"o":686,"w":"复"},{"d":36,"o":722,"w":"生"},{"d":36,"o":758,"w":""},{"d":36,"o":794,"w":"张"},{"d":37,"o":830,"w":"艾"},{"d":36,"o":867,"w":"嘉"},{"d":36,"o":903,"w":""},{"d":36,"o":939,"w":"詹"},{"d":36,"o":975,"w":"宏"},{"d":37,"o":1011,"w":"志"}]},{"d":179,"o":4290,"ws":[{"d":35,"o":0,"w":"曲"},{"d":36,"o":35,"w":"："},{"d":37,"o":71,"w":"罗"},{"d":35,"o":108,"w":"大"},{"d":36,"o":143,"w":"佑"}]},{"d":383,"o":4474,"ws":[{"d":37,"o":0,"w":"编"},{"d":36,"o":37,"w":"曲"},{"d":36,"o":73,"w":"："},{"d":36,"o":109,"w":"陈"},{"d":36,"o":145,"w":"志"},{"d":202,"o":181,"w":"远"}]},{"d":3003,"o":26410,"ws":[{"d":200,"o":0,"w":"轻"},{"d":160,"o":200,"w":"轻"},{"d":426,"o":360,"w":"敲"},{"d":384,"o":786,"w":"醒"},{"d":330,"o":1170,"w":"沉"},{"d":323,"o":1500,"w":"睡"},{"d":210,"o":1823,"w":"的"},{"d":340,"o":2033,"w":"心"},{"d":630,"o":2373,"w":"灵"}]},{"d":2911,"o":29623,"ws":[{"d":215,"o":0,"w":"慢"},{"d":203,"o":215,"w":"慢"},{"d":364,"o":418,"w":"张"},{"d":405,"o":782,"w":"开"},{"d":250,"o":1187,"w":"你"},{"d":184,"o":1437,"w":"的"},{"d":318,"o":1621,"w":"眼"},{"d":972,"o":1939,"w":"睛"}]},{"d":1833,"o":32864,"ws":[{"d":219,"o":0,"w":"看"},{"d":177,"o":219,"w":"看"},{"d":304,"o":396,"w":"忙"},{"d":216,"o":700,"w":"碌"},{"d":163,"o":916,"w":"的"},{"d":307,"o":1079,"w":"世"},{"d":447,"o":1386,"w":"界"}]},{"d":4582,"o":34905,"ws":[{"d":185,"o":0,"w":"是"},{"d":163,"o":185,"w":"否"},{"d":93,"o":348,"w":"依"},{"d":1125,"o":441,"w":"然"},{"d":265,"o":1566,"w":"孤"},{"d":251,"o":1831,"w":"独"},{"d":193,"o":2082,"w":"的"},{"d":415,"o":2275,"w":"转"},{"d":224,"o":2690,"w":"个"},{"d":344,"o":2914,"w":"不"},{"d":1324,"o":3258,"w":"停"}]},{"d":2698,"o":39821,"ws":[{"d":223,"o":0,"w":"春"},{"d":823,"o":223,"w":"风"},{"d":260,"o":1046,"w":"不"},{"d":203,"o":1306,"w":"解"},{"d":552,"o":1509,"w":"风"},{"d":637,"o":2061,"w":"情"}]},{"d":2498,"o":42976,"ws":[{"d":339,"o":0,"w":"吹"},{"d":334,"o":339,"w":"动"},{"d":379,"o":673,"w":"少"},{"d":463,"o":1052,"w":"年"},{"d":176,"o":1515,"w":"的"},{"d":807,"o":1691,"w":"心"}]},{"d":2763,"o":46050,"ws":[{"d":225,"o":0,"w":"让"},{"d":484,"o":225,"w":"昨"},{"d":328,"o":709,"w":"日"},{"d":325,"o":1037,"w":"脸"},{"d":285,"o":1362,"w":"上"},{"d":206,"o":1647,"w":"的"},{"d":344,"o":1853,"w":"泪"},{"d":566,"o":2197,"w":"痕"}]},{"d":4609,"o":49061,"ws":[{"d":381,"o":0,"w":"随"},{"d":366,"o":381,"w":"记"},{"d":361,"o":747,"w":"忆"},{"d":519,"o":1108,"w":"风"},{"d":646,"o":1627,"w":"干"},{"d":2336,"o":2273,"w":"了"}]},{"d":2649,"o":54057,"ws":[{"d":183,"o":0,"w":"抬"},{"d":132,"o":183,"w":"头"},{"d":215,"o":315,"w":"寻"},{"d":445,"o":530,"w":"找"},{"d":353,"o":975,"w":"天"},{"d":282,"o":1328,"w":"空"},{"d":171,"o":1610,"w":"的"},{"d":314,"o":1781,"w":"翅"},{"d":554,"o":2095,"w":"膀"}]},{"d":3358,"o":56944,"ws":[{"d":127,"o":0,"w":"候"},{"d":313,"o":127,"w":"鸟"},{"d":165,"o":440,"w":"出"},{"d":628,"o":605,"w":"现"},{"d":372,"o":1233,"w":"它"},{"d":174,"o":1605,"w":"的"},{"d":293,"o":1779,"w":"影"},{"d":1286,"o":2072,"w":"迹"}]},{"d":1681,"o":60470,"ws":[{"d":161,"o":0,"w":"带"},{"d":137,"o":161,"w":"来"},{"d":220,"o":298,"w":"远"},{"d":327,"o":518,"w":"处"},{"d":157,"o":845,"w":"的"},{"d":336,"o":1002,"w":"饥"},{"d":343,"o":1338,"w":"荒"}]},{"d":4582,"o":62158,"ws":[{"d":222,"o":0,"w":"无"},{"d":413,"o":222,"w":"情"},{"d":224,"o":635,"w":"的"},{"d":370,"o":859,"w":"战"},{"d":458,"o":1229,"w":"火"},{"d":188,"o":1687,"w":"依"},{"d":216,"o":1875,"w":"然"},{"d":186,"o":2091,"w":"存"},{"d":465,"o":2277,"w":"在"},{"d":187,"o":2742,"w":"的"},{"d":298,"o":2929,"w":"消"},{"d":1355,"o":3227,"w":"息"}]},{"d":2905,"o":67164,"ws":[{"d":336,"o":0,"w":"玉"},{"d":783,"o":336,"w":"山"},{"d":246,"o":1119,"w":"白"},{"d":350,"o":1365,"w":"雪"},{"d":500,"o":1715,"w":"飘"},{"d":690,"o":2215,"w":"零"}]},{"d":2780,"o":70308,"ws":[{"d":390,"o":0,"w":"燃"},{"d":453,"o":390,"w":"烧"},{"d":295,"o":843,"w":"少"},{"d":290,"o":1138,"w":"年"},{"d":256,"o":1428,"w":"的"},{"d":1096,"o":1684,"w":"心"}]},{"d":2593,"o":73388,"ws":[{"d":166,"o":0,"w":"使"},{"d":317,"o":166,"w":"真"},{"d":445,"o":483,"w":"情"},{"d":269,"o":928,"w":"溶"},{"d":425,"o":1197,"w":"化"},{"d":206,"o":1622,"w":"成"},{"d":329,"o":1828,"w":"音"},{"d":436,"o":2157,"w":"符"}]},{"d":3705,"o":76338,"ws":[{"d":317,"o":0,"w":"倾"},{"d":866,"o":317,"w":"诉"},{"d":148,"o":1183,"w":"遥"},{"d":206,"o":1331,"w":"远"},{"d":150,"o":1537,"w":"的"},{"d":332,"o":1687,"w":"祝"},{"d":1686,"o":2019,"w":"福"}]},{"d":1601,"o":81546,"ws":[{"d":220,"o":0,"w":"唱"},{"d":243,"o":220,"w":"出"},{"d":216,"o":463,"w":"你"},{"d":184,"o":679,"w":"的"},{"d":399,"o":863,"w":"热"},{"d":339,"o":1262,"w":"情"}]},{"d":1611,"o":83153,"ws":[{"d":281,"o":0,"w":"伸"},{"d":400,"o":281,"w":"出"},{"d":166,"o":681,"w":"你"},{"d":365,"o":847,"w":"双"},{"d":399,"o":1212,"w":"手"}]},{"d":2837,"o":84769,"ws":[{"d":200,"o":0,"w":"让"},{"d":214,"o":200,"w":"我"},{"d":182,"o":414,"w":"拥"},{"d":559,"o":596,"w":"抱"},{"d":211,"o":1155,"w":"着"},{"d":178,"o":1366,"w":"你"},{"d":169,"o":1544,"w":"的"},{"d":1124,"o":1713,"w":"梦"}]},{"d":5772,"o":87970,"ws":[{"d":463,"o":0,"w":"让"},{"d":280,"o":463,"w":"我"},{"d":441,"o":743,"w":"拥"},{"d":404,"o":1184,"w":"有"},{"d":175,"o":1588,"w":"你"},{"d":257,"o":1763,"w":"真"},{"d":434,"o":2020,"w":"心"},{"d":226,"o":2454,"w":"的"},{"d":914,"o":2680,"w":"面"},{"d":2178,"o":3594,"w":"孔"}]},{"d":1532,"o":94539,"ws":[{"d":197,"o":0,"w":"让"},{"d":176,"o":197,"w":"我"},{"d":168,"o":373,"w":"们"},{"d":153,"o":541,"w":"的"},{"d":441,"o":694,"w":"笑"},{"d":397,"o":1135,"w":"容"}]},{"d":4219,"o":96077,"ws":[{"d":408,"o":0,"w":"充"},{"d":195,"o":408,"w":"满"},{"d":189,"o":603,"w":"着"},{"d":408,"o":792,"w":"青"},{"d":237,"o":1200,"w":"春"},{"d":175,"o":1437,"w":"的"},{"d":1517,"o":1612,"w":"骄"},{"d":1090,"o":3129,"w":"傲"}]},{"d":5313,"o":100811,"ws":[{"d":219,"o":0,"w":"为"},{"d":331,"o":219,"w":"明"},{"d":411,"o":550,"w":"天"},{"d":292,"o":961,"w":"献"},{"d":449,"o":1253,"w":"出"},{"d":447,"o":1702,"w":"虔"},{"d":410,"o":2149,"w":"诚"},{"d":223,"o":2559,"w":"的"},{"d":711,"o":2782,"w":"祈"},{"d":1820,"o":3493,"w":"祷"}]},{"d":2981,"o":107038,"ws":[{"d":215,"o":0,"w":"谁"},{"d":154,"o":215,"w":"能"},{"d":292,"o":369,"w":"不"},{"d":473,"o":661,"w":"顾"},{"d":332,"o":1134,"w":"自"},{"d":377,"o":1466,"w":"己"},{"d":174,"o":1843,"w":"的"},{"d":358,"o":2017,"w":"家"},{"d":606,"o":2375,"w":"园"}]},{"d":2789,"o":110300,"ws":[{"d":194,"o":0,"w":"抛"},{"d":173,"o":194,"w":"开"},{"d":391,"o":367,"w":"记"},{"d":449,"o":758,"w":"忆"},{"d":197,"o":1207,"w":"中"},{"d":200,"o":1404,"w":"的"},{"d":284,"o":1604,"w":"童"},{"d":901,"o":1888,"w":"年"}]},{"d":3714,"o":113222,"ws":[{"d":737,"o":0,"w":"谁"},{"d":168,"o":737,"w":"能"},{"d":162,"o":905,"w":"忍"},{"d":372,"o":1067,"w":"心"},{"d":237,"o":1439,"w":"看"},{"d":447,"o":1676,"w":"那"},{"d":366,"o":2123,"w":"昨"},{"d":348,"o":2489,"w":"日"},{"d":257,"o":2837,"w":"的"},{"d":319,"o":3094,"w":"忧"},{"d":301,"o":3413,"w":"愁"}]},{"d":3278,"o":117103,"ws":[{"d":195,"o":0,"w":"带"},{"d":187,"o":195,"w":"走"},{"d":181,"o":382,"w":"我"},{"d":407,"o":563,"w":"们"},{"d":218,"o":970,"w":"的"},{"d":841,"o":1188,"w":"笑"},{"d":1249,"o":2029,"w":"容"}]},{"d":2627,"o":120497,"ws":[{"d":154,"o":0,"w":"青"},{"d":758,"o":154,"w":"春"},{"d":394,"o":912,"w":"不"},{"d":243,"o":1306,"w":"解"},{"d":422,"o":1549,"w":"红"},{"d":656,"o":1971,"w":"尘"}]},{"d":2745,"o":123300,"ws":[{"d":659,"o":0,"w":"胭"},{"d":362,"o":659,"w":"脂"},{"d":268,"o":1021,"w":"沾"},{"d":403,"o":1289,"w":"染"},{"d":192,"o":1692,"w":"了"},{"d":861,"o":1884,"w":"灰"}]},{"d":2853,"o":126470,"ws":[{"d":275,"o":0,"w":"让"},{"d":547,"o":275,"w":"久"},{"d":196,"o":822,"w":"违"},{"d":383,"o":1018,"w":"不"},{"d":301,"o":1401,"w":"见"},{"d":236,"o":1702,"w":"的"},{"d":357,"o":1938,"w":"泪"},{"d":558,"o":2295,"w":"水"}]},{"d":4240,"o":129615,"ws":[{"d":343,"o":0,"w":"滋"},{"d":572,"o":343,"w":"润"},{"d":292,"o":915,"w":"了"},{"d":226,"o":1207,"w":"你"},{"d":203,"o":1433,"w":"的"},{"d":440,"o":1636,"w":"面"},{"d":2164,"o":2076,"w":"容"}]},{"d":1596,"o":134808,"ws":[{"d":319,"o":0,"w":"唱"},{"d":184,"o":319,"w":"出"},{"d":162,"o":503,"w":"你"},{"d":157,"o":665,"w":"的"},{"d":375,"o":822,"w":"热"},{"d":399,"o":1197,"w":"情"}]},{"d":1569,"o":136410,"ws":[{"d":283,"o":0,"w":"伸"},{"d":393,"o":283,"w":"出"},{"d":180,"o":676,"w":"你"},{"d":295,"o":856,"w":"双"},{"d":418,"o":1151,"w":"手"}]},{"d":2752,"o":137984,"ws":[{"d":209,"o":0,"w":"让"},{"d":215,"o":209,"w":"我"},{"d":184,"o":424,"w":"拥"},{"d":537,"o":608,"w":"抱"},{"d":184,"o":1145,"w":"着"},{"d":177,"o":1329,"w":"你"},{"d":170,"o":1506,"w":"的"},{"d":1076,"o":1676,"w":"梦"}]},{"d":5537,"o":141216,"ws":[{"d":415,"o":0,"w":"让"},{"d":327,"o":415,"w":"我"},{"d":336,"o":742,"w":"拥"},{"d":398,"o":1078,"w":"有"},{"d":180,"o":1476,"w":"你"},{"d":310,"o":1656,"w":"真"},{"d":359,"o":1966,"w":"心"},{"d":306,"o":2325,"w":"的"},{"d":528,"o":2631,"w":"面"},{"d":2378,"o":3159,"w":"孔"}]},{"d":1536,"o":147741,"ws":[{"d":214,"o":0,"w":"让"},{"d":163,"o":214,"w":"我"},{"d":148,"o":377,"w":"们"},{"d":161,"o":525,"w":"的"},{"d":421,"o":686,"w":"笑"},{"d":429,"o":1107,"w":"容"}]},{"d":4444,"o":149283,"ws":[{"d":214,"o":0,"w":"充"},{"d":401,"o":214,"w":"满"},{"d":208,"o":615,"w":"着"},{"d":365,"o":823,"w":"青"},{"d":237,"o":1188,"w":"春"},{"d":177,"o":1425,"w":"的"},{"d":1487,"o":1602,"w":"骄"},{"d":1355,"o":3089,"w":"傲"}]},{"d":6448,"o":154036,"ws":[{"d":181,"o":0,"w":"为"},{"d":240,"o":181,"w":"明"},{"d":451,"o":421,"w":"天"},{"d":101,"o":872,"w":"献"},{"d":559,"o":973,"w":"出"},{"d":481,"o":1532,"w":"虔"},{"d":769,"o":2013,"w":"诚"},{"d":151,"o":2782,"w":"的"},{"d":837,"o":2933,"w":"祈"},{"d":2678,"o":3770,"w":"祷"}]},{"d":2753,"o":163622,"ws":[{"d":190,"o":0,"w":"轻"},{"d":135,"o":190,"w":"轻"},{"d":325,"o":325,"w":"敲"},{"d":336,"o":650,"w":"醒"},{"d":347,"o":986,"w":"沉"},{"d":300,"o":1333,"w":"睡"},{"d":216,"o":1633,"w":"的"},{"d":372,"o":1849,"w":"心"},{"d":532,"o":2221,"w":"灵"}]},{"d":3175,"o":166666,"ws":[{"d":211,"o":0,"w":"慢"},{"d":185,"o":211,"w":"慢"},{"d":378,"o":396,"w":"张"},{"d":402,"o":774,"w":"开"},{"d":282,"o":1176,"w":"你"},{"d":187,"o":1458,"w":"的"},{"d":290,"o":1645,"w":"眼"},{"d":1240,"o":1935,"w":"睛"}]},{"d":1784,"o":170046,"ws":[{"d":188,"o":0,"w":"看"},{"d":150,"o":188,"w":"看"},{"d":249,"o":338,"w":"忙"},{"d":353,"o":587,"w":"碌"},{"d":146,"o":940,"w":"的"},{"d":329,"o":1086,"w":"世"},{"d":369,"o":1415,"w":"界"}]},{"d":4994,"o":171837,"ws":[{"d":424,"o":0,"w":"是"},{"d":217,"o":424,"w":"否"},{"d":423,"o":641,"w":"依"},{"d":638,"o":1064,"w":"然"},{"d":361,"o":1702,"w":"孤"},{"d":321,"o":2063,"w":"独"},{"d":267,"o":2384,"w":"的"},{"d":267,"o":2651,"w":"转"},{"d":203,"o":2918,"w":"个"},{"d":659,"o":3121,"w":"不"},{"d":1214,"o":3780,"w":"停"}]},{"d":2700,"o":176901,"ws":[{"d":159,"o":0,"w":"日"},{"d":887,"o":159,"w":"出"},{"d":182,"o":1046,"w":"唤"},{"d":190,"o":1228,"w":"醒"},{"d":390,"o":1418,"w":"清"},{"d":892,"o":1808,"w":"晨"}]},{"d":2992,"o":179885,"ws":[{"d":401,"o":0,"w":"大"},{"d":488,"o":401,"w":"地"},{"d":190,"o":889,"w":"光"},{"d":368,"o":1079,"w":"彩"},{"d":503,"o":1447,"w":"重"},{"d":1042,"o":1950,"w":"生"}]},{"d":2723,"o":183066,"ws":[{"d":163,"o":0,"w":"让"},{"d":461,"o":163,"w":"和"},{"d":249,"o":624,"w":"风"},{"d":353,"o":873,"w":"拂"},{"d":340,"o":1226,"w":"出"},{"d":185,"o":1566,"w":"的"},{"d":317,"o":1751,"w":"音"},{"d":655,"o":2068,"w":"响"}]},{"d":3809,"o":186050,"ws":[{"d":345,"o":0,"w":"谱"},{"d":636,"o":345,"w":"成"},{"d":245,"o":981,"w":"生"},{"d":240,"o":1226,"w":"命"},{"d":208,"o":1466,"w":"的"},{"d":379,"o":1674,"w":"乐"},{"d":1756,"o":2053,"w":"章"}]},{"d":1404,"o":191351,"ws":[{"d":230,"o":0,"w":"唱"},{"d":170,"o":230,"w":"出"},{"d":146,"o":400,"w":"你"},{"d":129,"o":546,"w":"的"},{"d":346,"o":675,"w":"热"},{"d":383,"o":1021,"w":"情"}]},{"d":1598,"o":192761,"ws":[{"d":96,"o":0,"w":"伸"},{"d":502,"o":96,"w":"出"},{"d":254,"o":598,"w":"你"},{"d":336,"o":852,"w":"双"},{"d":410,"o":1188,"w":"手"}]},{"d":2800,"o":194364,"ws":[{"d":183,"o":0,"w":"让"},{"d":197,"o":183,"w":"我"},{"d":213,"o":380,"w":"拥"},{"d":563,"o":593,"w":"抱"},{"d":186,"o":1156,"w":"着"},{"d":190,"o":1342,"w":"你"},{"d":176,"o":1532,"w":"的"},{"d":1092,"o":1708,"w":"梦"}]},{"d":5863,"o":197666,"ws":[{"d":355,"o":0,"w":"让"},{"d":258,"o":355,"w":"我"},{"d":332,"o":613,"w":"拥"},{"d":374,"o":945,"w":"有"},{"d":268,"o":1319,"w":"你"},{"d":381,"o":1587,"w":"真"},{"d":382,"o":1968,"w":"心"},{"d":172,"o":2350,"w":"的"},{"d":589,"o":2522,"w":"面"},{"d":2752,"o":3111,"w":"孔"}]},{"d":1460,"o":204229,"ws":[{"d":175,"o":0,"w":"让"},{"d":260,"o":175,"w":"我"},{"d":141,"o":435,"w":"们"},{"d":136,"o":576,"w":"的"},{"d":335,"o":712,"w":"笑"},{"d":413,"o":1047,"w":"容"}]},{"d":4359,"o":205695,"ws":[{"d":211,"o":0,"w":"充"},{"d":388,"o":211,"w":"满"},{"d":209,"o":599,"w":"着"},{"d":380,"o":808,"w":"青"},{"d":202,"o":1188,"w":"春"},{"d":187,"o":1390,"w":"的"},{"d":1555,"o":1577,"w":"骄"},{"d":1227,"o":3132,"w":"傲"}]},{"d":6050,"o":210231,"ws":[{"d":179,"o":0,"w":"让"},{"d":497,"o":179,"w":"我"},{"d":441,"o":676,"w":"们"},{"d":186,"o":1117,"w":"期"},{"d":642,"o":1303,"w":"待"},{"d":333,"o":1945,"w":"明"},{"d":419,"o":2278,"w":"天"},{"d":174,"o":2697,"w":"会"},{"d":631,"o":2871,"w":"更"},{"d":2548,"o":3502,"w":"好"}]},{"d":1479,"o":217097,"ws":[{"d":174,"o":0,"w":"唱"},{"d":155,"o":174,"w":"出"},{"d":166,"o":329,"w":"你"},{"d":195,"o":495,"w":"的"},{"d":384,"o":690,"w":"热"},{"d":405,"o":1074,"w":"情"}]},{"d":1592,"o":218586,"ws":[{"d":79,"o":0,"w":"伸"},{"d":505,"o":79,"w":"出"},{"d":170,"o":584,"w":"你"},{"d":386,"o":754,"w":"双"},{"d":452,"o":1140,"w":"手"}]},{"d":2946,"o":220183,"ws":[{"d":190,"o":0,"w":"让"},{"d":199,"o":190,"w":"我"},{"d":198,"o":389,"w":"拥"},{"d":506,"o":587,"w":"抱"},{"d":213,"o":1093,"w":"着"},{"d":181,"o":1306,"w":"你"},{"d":181,"o":1487,"w":"的"},{"d":1278,"o":1668,"w":"梦"}]},{"d":5719,"o":223580,"ws":[{"d":184,"o":0,"w":"让"},{"d":421,"o":184,"w":"我"},{"d":375,"o":605,"w":"拥"},{"d":385,"o":980,"w":"有"},{"d":235,"o":1365,"w":"你"},{"d":250,"o":1600,"w":"真"},{"d":405,"o":1850,"w":"心"},{"d":180,"o":2255,"w":"的"},{"d":599,"o":2435,"w":"面"},{"d":2685,"o":3034,"w":"孔"}]},{"d":1449,"o":229970,"ws":[{"d":185,"o":0,"w":"让"},{"d":159,"o":185,"w":"我"},{"d":157,"o":344,"w":"们"},{"d":174,"o":501,"w":"的"},{"d":436,"o":675,"w":"笑"},{"d":338,"o":1111,"w":"容"}]},{"d":4249,"o":231565,"ws":[{"d":142,"o":0,"w":"充"},{"d":428,"o":142,"w":"满"},{"d":198,"o":570,"w":"着"},{"d":336,"o":768,"w":"青"},{"d":272,"o":1104,"w":"春"},{"d":154,"o":1376,"w":"的"},{"d":1557,"o":1530,"w":"骄"},{"d":1162,"o":3087,"w":"傲"}]},{"d":5733,"o":236277,"ws":[{"d":112,"o":0,"w":"让"},{"d":348,"o":112,"w":"我"},{"d":399,"o":460,"w":"们"},{"d":168,"o":859,"w":"期"},{"d":693,"o":1027,"w":"待"},{"d":312,"o":1720,"w":"明"},{"d":413,"o":2032,"w":"天"},{"d":175,"o":2445,"w":"会"},{"d":660,"o":2620,"w":"更"},{"d":2453,"o":3280,"w":"好"}]},{"d":1440,"o":242952,"ws":[{"d":294,"o":0,"w":"唱"},{"d":144,"o":294,"w":"出"},{"d":138,"o":438,"w":"你"},{"d":127,"o":576,"w":"的"},{"d":378,"o":703,"w":"热"},{"d":359,"o":1081,"w":"情"}]},{"d":1593,"o":244398,"ws":[{"d":99,"o":0,"w":"伸"},{"d":555,"o":99,"w":"出"},{"d":164,"o":654,"w":"你"},{"d":362,"o":818,"w":"双"},{"d":413,"o":1180,"w":"手"}]},{"d":2010,"o":245996,"ws":[{"d":90,"o":0,"w":"让"},{"d":297,"o":90,"w":"我"},{"d":66,"o":387,"w":"拥"},{"d":683,"o":453,"w":"抱"},{"d":176,"o":1136,"w":"着"},{"d":188,"o":1312,"w":"你"},{"d":244,"o":1500,"w":"的"},{"d":266,"o":1744,"w":"梦"}]},{"d":1416,"o":248014,"ws":[{"d":153,"o":0,"w":"拥"},{"d":147,"o":153,"w":"抱"},{"d":557,"o":300,"w":"着"},{"d":171,"o":857,"w":"你"},{"d":120,"o":1028,"w":"的"},{"d":268,"o":1148,"w":"梦"}]},{"d":3466,"o":249436,"ws":[{"d":147,"o":0,"w":"让"},{"d":382,"o":147,"w":"我"},{"d":296,"o":529,"w":"拥"},{"d":499,"o":825,"w":"有"},{"d":169,"o":1324,"w":"你"},{"d":297,"o":1493,"w":"真"},{"d":384,"o":1790,"w":"心"},{"d":233,"o":2174,"w":"的"},{"d":590,"o":2407,"w":"面"},{"d":469,"o":2997,"w":"孔"}]},{"d":3406,"o":252912,"ws":[{"d":71,"o":0,"w":"让"},{"d":241,"o":71,"w":"我"},{"d":385,"o":312,"w":"拥"},{"d":424,"o":697,"w":"有"},{"d":177,"o":1121,"w":"你"},{"d":1110,"o":1298,"w":"真"},{"d":272,"o":2408,"w":"心"},{"d":153,"o":2680,"w":"的"},{"d":414,"o":2833,"w":"面"},{"d":159,"o":3247,"w":"孔"}]},{"d":984,"o":256328,"ws":[{"d":147,"o":0,"w":"让"},{"d":123,"o":147,"w":"我"},{"d":138,"o":270,"w":"们"},{"d":171,"o":408,"w":"的"},{"d":157,"o":579,"w":"笑"},{"d":248,"o":736,"w":"容"}]},{"d":3645,"o":257318,"ws":[{"d":244,"o":0,"w":"充"},{"d":348,"o":244,"w":"满"},{"d":225,"o":592,"w":"着"},{"d":362,"o":817,"w":"青"},{"d":249,"o":1179,"w":"春"},{"d":154,"o":1428,"w":"的"},{"d":1622,"o":1582,"w":"骄"},{"d":441,"o":3204,"w":"傲"}]},{"d":1340,"o":260971,"ws":[{"d":55,"o":0,"w":"青"},{"d":674,"o":55,"w":"春"},{"d":164,"o":729,"w":"的"},{"d":292,"o":893,"w":"骄"},{"d":155,"o":1185,"w":"傲"}]},{"d":4540,"o":262316,"ws":[{"d":104,"o":0,"w":"让"},{"d":178,"o":104,"w":"我"},{"d":361,"o":282,"w":"们"},{"d":276,"o":643,"w":"期"},{"d":471,"o":919,"w":"待"},{"d":456,"o":1390,"w":"明"},{"d":393,"o":1846,"w":"天"},{"d":274,"o":2239,"w":"会"},{"d":663,"o":2513,"w":"更"},{"d":1364,"o":3176,"w":"好"}]},{"d":1423,"o":268804,"ws":[{"d":165,"o":0,"w":"唱"},{"d":129,"o":165,"w":"出"},{"d":144,"o":294,"w":"你"},{"d":148,"o":438,"w":"的"},{"d":409,"o":586,"w":"热"},{"d":428,"o":995,"w":"情"}]},{"d":1584,"o":270233,"ws":[{"d":97,"o":0,"w":"伸"},{"d":495,"o":97,"w":"出"},{"d":212,"o":592,"w":"你"},{"d":374,"o":804,"w":"双"},{"d":406,"o":1178,"w":"手"}]},{"d":2941,"o":271822,"ws":[{"d":188,"o":0,"w":"让"},{"d":262,"o":188,"w":"我"},{"d":163,"o":450,"w":"拥"},{"d":474,"o":613,"w":"抱"},{"d":215,"o":1087,"w":"着"},{"d":194,"o":1302,"w":"你"},{"d":170,"o":1496,"w":"的"},{"d":1275,"o":1666,"w":"梦"}]},{"d":3099,"o":275289,"ws":[{"d":186,"o":0,"w":"让"},{"d":392,"o":186,"w":"我"},{"d":396,"o":578,"w":"拥"},{"d":276,"o":974,"w":"有"},{"d":165,"o":1250,"w":"你"},{"d":395,"o":1415,"w":"真"},{"d":306,"o":1810,"w":"心"},{"d":180,"o":2116,"w":"的"},{"d":608,"o":2296,"w":"面"},{"d":195,"o":2904,"w":"孔"}]},{"d":2653,"o":278398,"ws":[{"d":136,"o":0,"w":"你"},{"d":133,"o":136,"w":"真"},{"d":379,"o":269,"w":"心"},{"d":291,"o":648,"w":"的"},{"d":484,"o":939,"w":"面"},{"d":1230,"o":1423,"w":"孔"}]},{"d":1219,"o":281699,"ws":[{"d":168,"o":0,"w":"让"},{"d":137,"o":168,"w":"我"},{"d":146,"o":305,"w":"们"},{"d":157,"o":451,"w":"的"},{"d":366,"o":608,"w":"笑"},{"d":245,"o":974,"w":"容"}]},{"d":2304,"o":283098,"ws":[{"d":161,"o":0,"w":"充"},{"d":430,"o":161,"w":"满"},{"d":195,"o":591,"w":"着"},{"d":383,"o":786,"w":"青"},{"d":194,"o":1169,"w":"春"},{"d":193,"o":1363,"w":"的"},{"d":588,"o":1556,"w":"骄"},{"d":160,"o":2144,"w":"傲"}]},{"d":1963,"o":285410,"ws":[{"d":143,"o":0,"w":"青"},{"d":121,"o":143,"w":"春"},{"d":152,"o":264,"w":"的"},{"d":529,"o":416,"w":"骄"},{"d":1018,"o":945,"w":"傲"}]},{"d":5776,"o":287785,"ws":[{"d":95,"o":0,"w":"让"},{"d":404,"o":95,"w":"我"},{"d":422,"o":499,"w":"们"},{"d":297,"o":921,"w":"期"},{"d":508,"o":1218,"w":"待"},{"d":422,"o":1726,"w":"明"},{"d":396,"o":2148,"w":"天"},{"d":183,"o":2544,"w":"会"},{"d":761,"o":2727,"w":"更"},{"d":2288,"o":3488,"w":"好"}]},{"d":1437,"o":294538,"ws":[{"d":170,"o":0,"w":"唱"},{"d":143,"o":170,"w":"出"},{"d":151,"o":313,"w":"你"},{"d":179,"o":464,"w":"的"},{"d":412,"o":643,"w":"热"},{"d":382,"o":1055,"w":"情"}]},{"d":1586,"o":295981,"ws":[{"d":77,"o":0,"w":"伸"},{"d":488,"o":77,"w":"出"},{"d":194,"o":565,"w":"你"},{"d":399,"o":759,"w":"双"},{"d":428,"o":1158,"w":"手"}]},{"d":2048,"o":297572,"ws":[{"d":64,"o":0,"w":"让"},{"d":310,"o":64,"w":"我"},{"d":200,"o":374,"w":"拥"},{"d":481,"o":574,"w":"抱"},{"d":194,"o":1055,"w":"着"},{"d":187,"o":1249,"w":"你"},{"d":194,"o":1436,"w":"的"},{"d":418,"o":1630,"w":"梦"}]},{"d":1445,"o":299628,"ws":[{"d":155,"o":0,"w":"拥"},{"d":149,"o":155,"w":"抱"},{"d":519,"o":304,"w":"着"},{"d":88,"o":823,"w":"你"},{"d":153,"o":911,"w":"的"},{"d":381,"o":1064,"w":"梦"}]},{"d":3274,"o":301079,"ws":[{"d":153,"o":0,"w":"让"},{"d":194,"o":153,"w":"我"},{"d":355,"o":347,"w":"拥"},{"d":456,"o":702,"w":"有"},{"d":174,"o":1158,"w":"你"},{"d":379,"o":1332,"w":"真"},{"d":344,"o":1711,"w":"心"},{"d":237,"o":2055,"w":"的"},{"d":641,"o":2292,"w":"面"},{"d":341,"o":2933,"w":"孔"}]},{"d":1052,"o":304363,"ws":[{"d":171,"o":0,"w":"真"},{"d":313,"o":171,"w":"心"},{"d":189,"o":484,"w":"的"},{"d":218,"o":673,"w":"面"},{"d":161,"o":891,"w":"孔"}]},{"d":2418,"o":305420,"ws":[{"d":161,"o":0,"w":"拥"},{"d":136,"o":161,"w":"有"},{"d":139,"o":297,"w":"你"},{"d":983,"o":436,"w":"真"},{"d":285,"o":1419,"w":"心"},{"d":386,"o":1704,"w":"的"},{"d":191,"o":2090,"w":"面"},{"d":137,"o":2281,"w":"孔"}]},{"d":1003,"o":307846,"ws":[{"d":137,"o":0,"w":"让"},{"d":134,"o":137,"w":"我"},{"d":119,"o":271,"w":"们"},{"d":139,"o":390,"w":"的"},{"d":167,"o":529,"w":"笑"},{"d":307,"o":696,"w":"容"}]},{"d":4325,"o":308855,"ws":[{"d":111,"o":0,"w":"充"},{"d":484,"o":111,"w":"满"},{"d":183,"o":595,"w":"着"},{"d":387,"o":778,"w":"青"},{"d":181,"o":1165,"w":"春"},{"d":226,"o":1346,"w":"的"},{"d":1463,"o":1572,"w":"骄"},{"d":1290,"o":3035,"w":"傲"}]},{"d":4238,"o":313487,"ws":[{"d":177,"o":0,"w":"让"},{"d":459,"o":177,"w":"我"},{"d":346,"o":636,"w":"们"},{"d":335,"o":982,"w":"期"},{"d":490,"o":1317,"w":"待"},{"d":450,"o":1807,"w":"明"},{"d":410,"o":2257,"w":"天"},{"d":226,"o":2667,"w":"会"},{"d":606,"o":2893,"w":"更"},{"d":739,"o":3499,"w":"好"}]}];
// var offset = 0;
// var duration = 0;
// for (var i = 0; i < 1000; i++) {
// 	duration = 7400; 
// 	lines.push({'ws':[{'w':"这", 'o':0, 'd':300},{'w':"是", 'o':300, 'd':400},{'w':"歌", 'o':700, 'd':200},{'w':"词", 'o':900, 'd':500},{'w':"测", 'o':1900, 'd':100},{'w':"试", 'o':2000, 'd':400},{'w':"，", 'o':2400, 'd':800},{'w':"请", 'o':3200, 'd':1200},{'w':"关", 'o':4400, 'd':1000},{'w':"注", 'o':5400, 'd':200},{'w':"效", 'o':5600, 'd':1600},{'w':"果", 'o':7200, 'd':200}], 'o':offset, 'd':duration});
// 	offset += 7400; 
// 	duration = 7300; 	
// 	lines.push({'ws':[{'w':"经", 'o':0, 'd':200},{'w':"测", 'o':200, 'd':500},{'w':"试", 'o':700, 'd':200},{'w':"，", 'o':900, 'd':1000},{'w':"网", 'o':1900, 'd':200},{'w':"页", 'o':2100, 'd':500},{'w':"的", 'o':2600, 'd':200},{'w':"效", 'o':2800, 'd':300},{'w':"果", 'o':3900, 'd':300},{'w':"也", 'o':4200, 'd':100},{'w':"还", 'o':4300, 'd':300},{'w':"不", 'o':5700, 'd':600},{'w':"错", 'o':6300, 'd':1000}], 'o':offset, 'd':duration});
// 	offset += 7300; 
// }




	var screenId;
	var screenCount;
	 if (window.location.search.split('?')[1]) {
	 	var search = window.location.search.split('?')[1].split('&');

	 	for (var i = 0 ; i < search.length ; i++ ) {
	 		var key = search[i].split('=')[0];
	 		if ("screenId" === key) {
	 			screenId = parseInt(search[i].split('=')[1]);
				$("#screen_mark").innerHTML = "我是第" + screenId + "台计算机";
	 		}
	 		if ("screenCount" === key) {
	 			screenCount = parseInt(search[i].split('=')[1]);
	 		}
	 	}
	 }

	/*
    将解析后的一行歌词添加到dom中
    */
var _etext = document.getElementById("text");
var wstoes = function(words) {
	var ps = "";
	for (var i = 0; i < words.length; i++) {
		ps += "<p>" + words[i]['w'] + "</p>";
	}
	_etext.innerHTML = ps;

	var _eps = _etext.getElementsByTagName("p");
	for (var i = 0; i < words.length; i++) {
		_eps[i].offset = words[i]['o'];
		_eps[i].duration = words[i]['d'];
	}
	return _eps;
}


var step = 30; // 默认刷新时长30ms，刷新时长配置对桌面歌词性能影响较大
var timer; // 启动单个字推进的定时器
/*
处理单个显示元素
_eps: dom节点列表，表示歌词中单个显示元素
_index: 当前变化元素的索引
_ps: process step，每次timeout推进的步长
_process: 当前变化元素的进度（0-100）
pos: 对该元素进行处理时间点，在哪个timeout点处理
count: timeout的次数
*/
var _processw = function(_eps, _index, _ps, _process, pos, count){
	_ep = _eps[_index];
	if (count >= pos) {
		_process += _ps;
		_ep.style.backgroundImage = "-webkit-linear-gradient(top, rgba(255,255,255,0.5) 0%, rgba(255,255,255,0) 100%), -webkit-linear-gradient(left, #f00 " + _process + "%, #00f 0%)";
		
		if (_process >= 99) {
			if ((_index+1) >= _eps.length) { //该句结束退出
				return;
			}
			_index++;
			var ts = Math.round(_eps[_index].duration/step)==0?1:Math.round(_eps[_index].duration/step);
			_ps = 100/ts;
			_process = 0;
			pos = Math.round(_eps[_index].offset/step);
		}
	}
	count++;
	timer = setTimeout(_processw.bind(this, _eps, _index, _ps, _process, pos, count), step);
}

/*
处理单行
*/
var _processL = function(words) {
	var _eps = wstoes(words);
	clearTimeout(timer); //清除上一行因为页面渲染延迟没有处理完的定时器
	_processw(_eps, 0, 100/Math.round(_eps[0].duration/step), 0, Math.round(_eps[0].offset/step), 0);
}

/*
处理全部krc歌词
*/
var timers = [];
var _processK = function() {
	for (var i = 0; i < lines.length; i++) {
		var timer = setTimeout(_processL.bind(this, lines[i]['ws']), lines[i]['o']);
		timers.push(timer);
	}
	var leftOffset = document.body.offsetWidth * screenId;
	$('body').css('position', 'absolute').css('left', -leftOffset);
	$('body').css('width', screenCount * 100 + '%')
}


	var server_location = window.location.origin;
 	var web_socket_server_location = server_location.replace("https:", "ws:").replace("http:", "ws:");

 	var ws = new WebSocket(web_socket_server_location + "/chat-room/" + screenId);// 与服务器建立长连接

	ws.onopen = function(evt) {
		console.log('Connection open ...');
		ws.send('Hello WebSockets!');
	}

	ws.onmessage = function(evt) {
		console.log('Received Message: ' + evt.data)
		// ws.close();

		if ("start" === evt.data) {
			//启动处理
			_processK();
		}

		if ("reset" === evt.data) {
			window.location.reload();
		}
	}

	ws.onclose = function(evt) {
		console.log('Connection closed!');
	}


//启动处理
//_processK();


///////////////////////////////////////////////////////
// 下面是一些用户操作响应
document.getElementById("text").addEventListener("mousedown", winmove, false);
document.getElementById("bigger").addEventListener("click", bigger, false);
document.getElementById("smaller").addEventListener("click", smaller, false);
document.getElementById("lock").addEventListener("click", lock, false);
document.getElementById("close").addEventListener("click", close, false);
function winmove(_Event){
	channel.Call('winctrl.dragWindow');
}
/*
字体变大
*/
var fontsize = 60;
function bigger(_Event){
	if (fontsize < 80){
		fontsize += 2;
		var font = "normal normal bold " + fontsize + "px 微软雅黑,sans-serif"
		_etext.style.font = font;
	}
}
/*
字体变小
*/
function smaller(_Event){
	if (fontsize > 16){
			fontsize -= 2;
			var font = "normal normal bold " + fontsize + "px 微软雅黑,sans-serif"
			_etext.style.font = font;
	} 
}
/*
窗口锁定，在PC混合应用容器中有效
*/
function lock(_Event){
	if(typeof(channel) == "undefined") {
		alert("窗口锁定功能只在pc混合应用容器中有效");
	} else {
		channel.Call('winctrl.lockwindow');
	}
}
/*
窗口关闭，在PC混合应用容器中有效
*/
function close(_Event){
	if(typeof(channel) == "undefined") {
		alert("窗口关闭功能只在pc混合应用容器中有效");
	} else {
		channel.Call('winctrl.sendMessage', [{"src":"lrc", "action":"close"}]);
	}
	
}

})();
	</script>
</body>
</html>

